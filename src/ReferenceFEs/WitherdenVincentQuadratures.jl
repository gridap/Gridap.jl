struct WitherdenVincent <: QuadratureName end
const witherden_vincent = WitherdenVincent()

# Reference:
# `On the identification of symmetric quadrature rules for finite element methods`
# F.D. Witherden, P.E. Vincent, Computers & Mathematics with Applications (2015)
# DOI: https://doi.org/10.1016/j.camwa.2015.03.017

function Quadrature(
  p::Polytope, ::WitherdenVincent, degree::Integer; T::Type{<:AbstractFloat}=Float64
)
  if p == TRI
    wx = _witherdenvincent_quad_tri(degree; T)
  elseif p == TET
    wx = _witherdenvincent_quad_tet(degree; T)
  elseif p == QUAD
    wx = _witherdenvincent_quad_quad(degree; T)
  elseif p == HEX
    wx = _witherdenvincent_quad_hex(degree; T)
  elseif p == WEDGE
    wx = _witherdenvincent_quad_wedge(degree; T)
  elseif p == PYRAMID
    wx = _witherdenvincent_quad_pyramid(degree; T)
  else
    msg = """\n
  `witherden_vincent` quadrature rule only available for triangles and tetrahedra,
  squares and cubes, wedges and pyramids.
  Use `duffy` for other simplices and `tensor_product` for other n-cubes.
  """
    error(msg)
  end
  coords, weights = _weightcoords_to_coord_weights(p, wx, T)
  GenericQuadrature(coords, weights, "Witherden-Vincent - $(string(p)) - degree $(degree)")
end

function maxdegree(p::Polytope, ::WitherdenVincent)
  if p == TRI
    20
  elseif p == TET
    10
  elseif p == QUAD
    21
  elseif p == HEX
    11
  elseif p == WEDGE
    10
  elseif p == PYRAMID
    10
  else
    0
  end
end

#######
# TRI #
#######
function _witherdenvincent_quad_tri(degree; T::Type{<:AbstractFloat}=Float64)
  maxdegree = 20
  if degree > maxdegree
    msg = """\n
    `witherden_vincent` quadrature rule only available up to degree $(maxdegree) on a triangle.
    Use `duffy` instead.
    """
    error(msg)
  end

  data1 = -one(T) # w (-1/3, -1/3)
  data2 = Tuple{T,T,T}[] # w (s, t) (t, s) (s, s)
  data3 = Tuple{T,T,T,T}[] # w (s, t) (t, s) (s, u) (u, s) (t, u) (u, t)

  if degree in (0, 1)
    data1 = 2.0
  elseif degree == 2
    data2 = [
      (0.66666666666666666666666666666666666667, -0.66666666666666666666666666666666666667, 0.33333333333333333333333333333333333333)
    ]
  elseif degree in (3, 4)
    data2 = [
      (0.44676317935602293139001401686624560874, -0.1081030181680702273633414922338960232, -0.7837939636638595452733170155322079536),
      (0.21990348731064373527665264980042105793, -0.81684757298045851308085707319559698429, 0.63369514596091702616171414639119396858)
    ]
  elseif degree == 5
    data1 = 0.45
    data2 = [
      (0.25187836108965430519136789100036266732, -0.79742698535308732239802527616975234389, 0.59485397070617464479605055233950468778),
      (0.26478830557701236147529877566630399935, -0.059715871789769820459117580973104798968, -0.88056825642046035908176483805379040206)
    ]
  elseif degree == 6
    data2 = [
      (0.10168981274041363384187361821373796809, -0.87382197101699554331933679425836168532, 0.74764394203399108663867358851672337064),
      (0.23357255145275873205057922277115888265, -0.50142650965817915741672289378596184782, 0.0028530193163583148334457875719236956481)
    ]
    data3 = [
      (0.16570215123674715038710691284088490796, -0.89370990031036610529350065673720370601, 0.27300499824279729446028518882409939961, -0.37929509793243118916678453208689569359)
    ]
  elseif degree == 7
    data2 = [
      (0.033090100221584262071955896945834891238, -0.93253870289082430257005654739836752385, 0.8650774057816486051401130947967350477),
      (0.25588834246031114556580247036929262133, -0.51684523480919288209962646032443600082, 0.033690469618385764199252920648872001638),
      (0.15417329237197213566964304166748277293, -0.051380614990563531580838528101628435036, -0.89723877001887293683832294379674312993)
    ]
    data3 = [
      (0.11175746580639956167963262884202819059, -0.90592671069480953331718004928623004897, 0.50856008110010635471247864925623992738, -0.60263337040529682139529859997000987842)
    ]
  elseif degree == 8
    data1 = 0.2886312153555743365021822209781292496
    data2 = [
      (0.1901832685345692495877922087771686332, -0.081414823414553687942368971011661355879, -0.83717035317089262411526205797667728824),
      (0.20643474106943650056358310058425806003, -0.65886138449647958675541299701707099796, 0.31772276899295917351082599403414199593),
      (0.064916995246396160621851856683561193593, -0.89890554336593804908315289880680210631, 0.79781108673187609816630579761360421262)
    ]
    data3 = [
      (0.05446062834886998852968938014781784832, -0.98321044518008478932557233092141110162, 0.45698478591080856248200075835212392604, -0.47377434073072377315642842743071282442)
    ]
  elseif degree == 9
    data1 = 0.19427159256559766763848396501457725948
    data2 = [
      (0.15565508200954855863347871259880791224, -0.12582081701412672546013927112929005464, -0.74835836597174654907972145774141989072),
      (0.1592954778544205060657835485280905465, -0.62359292876193453951807743906532886378, 0.24718585752386907903615487813065772755),
      (0.062669400454278141073709662574418630986, -0.020634961602524744432586150327614401262, -0.95873007679495051113482769934477119748),
      (0.051155351317396062523357597117999647955, -0.91054097321109458026978682006744727, 0.82108194642218916053957364013489454)
    ]
    data3 = [
      (0.086567078754578754578754578754578754579, -0.92632317589052743273036480243322979538, 0.48239719756899604138015974704684765487, -0.55607402167846860864979494461361785949)
    ]
  elseif degree == 10
    data1 = 0.16348665829257193285623736996835522439
    data2 = [
      (0.026705937626299132551145956798137306994, -0.93588925356611297413803082132702052207, 0.87177850713222594827606164265404104414),
      (0.0919159272094894560275758192650956328, -0.71567779788687122981567579361808335656, 0.43135559577374245963135158723616671312)
    ]
    data3 = [
      (0.12780981279284809086579746752530664373, -0.35637400942232915754980487802790257253, 0.060108237854688056554191347891388233782, -0.70373422843235889900438646986348566125),
      (0.068369296325918857257383168082684580517, -0.94076022102254046473232746114791439895, 0.20246665736691849090948578691737561875, -0.2617064363443780261771583257694612198),
      (0.050595515414576768778085581365666435125, -0.94326466932012312149912848884373958881, 0.61586120184575813015989980576348821814, -0.67259653252563500866077131691974862932)
    ]
  elseif degree == 11
    data1 = 0.17152235946444843427639825073065398895
    data2 = [
      (0.020863741025789391746056984197324633703, -0.94302916477125618104036726638981901865, 0.8860583295425123620807345327796380373),
      (0.14103136822343315668414771834585673963, -0.57956008659364348598387546330841477973, 0.15912017318728697196775092661682955946),
      (0.077261518474038644953267609178802298293, -0.79472903457550713910176986023011167594, 0.58945806915101427820353972046022335189),
      (0.03321254610917073915275167855011212173, -0.0082161980682181738701197619927680147278, -0.98356760386356365225976047601446397054),
      (0.13463230815893660239567441124657557177, -0.12306814647129561795332827431496109166, -0.75386370705740876409334345137007781667)
    ]
    data3 = [
      (0.020580579145906554986161254967959059438, -0.70135042269583522760854842424565295474, 0.68669956732370632439798287279764986108, -0.98534914462787109678943444855199690633),
      (0.080664953281001105168489835817596259842, -0.90797899966914008822008044741026548976, 0.3288167483937283948070953526650315723, -0.42083774872458830658701490525476608254)
    ]
  elseif degree == 12
    data2 = [
      (0.048533676162904066301435945151216167798, -0.023592498108916896443983752262370486151, -0.9528150037821662071120324954752590277),
      (0.056972104137755089999388947815030892501, -0.78148434468129141883250537599138250938, 0.56296868936258283766501075198276501876),
      (0.12508242639180552093864756289103967826, -0.45707498597014783024400810395490980293, -0.08585002805970433951198379209018039414),
      (0.015863285019947276918629575811719468968, -0.9507072731273288104665376055713308436, 0.90141454625465762093307521114266168719),
      (0.099836669856121884238103444121988601916, -0.11977670268281377797309259385418361789, -0.76044659463437244405381481229163276421)
    ]
    data3 = [
      (0.043567170077215115865262872678583643728, -0.41668864052331807893217237613211876563, 0.3706203278127837999688893722742605014, -0.95393168728946572103671699614214173577),
      (0.08645472731882842109826654183371845927, -0.7674079606441468267385037317005977222, 0.25649950336711213367579227673445839675, -0.48909154272296530693728854503386067454),
      (0.030167355153022877171701180925533825614, 0.70267558502048008323600722086411689719, -0.74544056553282126242431625050523532213, -0.95723501948765882081169097035888157506)
    ]
  elseif degree == 13
    data1 = 0.13592007317366328856354884936176975902
    data2 = [
      (0.047988803857789461547421598901919307449, -0.02184610709492130019862056181959122469, -0.95630778581015739960275887636081755062),
      (0.11655697023839996280953416702667961903, -0.55725542741633419869037489058984184448, 0.11451085483266839738074978117968368896),
      (0.11120393506090665741451493202092293506, -0.14611717148039918795837492993725157719, -0.70776565703920162408325014012549684562),
      (0.012104674207078343683585600064581648939, -0.9569806377823136322614173729318958348, 0.91396127556462726452283474586379166961)
    ]
    data3 = [
      (0.048358079623187638274891491146121518585, -0.82420903393560535081381299499933379777, 0.49701423179990439034603719157741930009, -0.67280519786429903953222419657808550232),
      (0.029930802210331334526491714265806876009, -0.77815591439307320917426090955665095644, 0.72941554059088555060509190179138636667, -0.95125962619781234143083099223473541023),
      (0.069282552281696740931973657021836440891, -0.38311647821576445068305629491750938056, 0.24709199110735114163170870637247317166, -0.8639755128915866909486524114549637911),
      (0.019181362007086525445190180332221782772, -0.98974722179523526288134119331774178805, 0.44471558624837593052124026460956809725, -0.4549683644531406676398990712918263092)
    ]
  elseif degree == 14
    data2 = [
      (0.084325177473986035076460874648372259691, -0.64558893517491312608677861906988184783, 0.29117787034982625217355723813976369567),
      (0.065576707088250701282621957477250686472, -0.16471056131909215498111835562871312178, -0.67057887736181569003776328874257375644),
      (0.028867399339553335203419842961306633228, -0.87640023381825479746504234312612842323, 0.75280046763650959493008468625225684647),
      (0.043767162738857781281689891926651943066, -0.022072179275642722645247959095219528414, -0.95585564144871455470950408180956094317),
      (0.10354820901458317262956982033279280483, -0.45304494338232268049011143347460288761, -0.093910113235354639019777133050794224782),
      (0.009846807204800163363652047018084309531, -0.96121807750259790364349980989094097785, 0.9224361550051958072869996197818819557)
    ]
    data3 = [
      (0.028872616227067680992177383998031606893, -0.40325423572748449405833696388077454282, 0.37396033561617567471725430804062611952, -0.97070609988869118065891734415985157669),
      (0.049331506425127347925750490367272456636, -0.88575048519270412192864575156217057937, 0.54121710954999296517806654833485591265, -0.65546662435728884324942079677268533329),
      (0.077143021574121366456978055620821718469, -0.32627708040730999651188960582214922188, 0.14044458169336634699539242672470851928, -0.8141675012860563504835028209025592974),
      (0.010020457677001343539720186164978232925, -0.99746333813425594982550719780901461465, 0.75951434274034225902914327394920365201, -0.76205100460608630920363607614018903735)
    ]
  elseif degree == 15
    data1 = 0.08867077476436815077519868131406480795
    data2 = [
      (0.085427563142921134082725838745668360696, -0.18927557173204904426648777856049828207, -0.62144885653590191146702444287900343586),
      (0.03288947512525032753736001737701825892, -0.85965289420002796503128049571314279073, 0.71930578840005593006256099142628558146),
      (0.034792296001526829115453101768509506658, -0.051658637123960416042618609451788188253, -0.89668272575207916791476278109642362349),
      (0.093566723457419264712537789561548478374, -0.54724257315930080341854883783076139455, 0.094485146318601606837097675661522789095),
      (0.019147692364920172413138507253187117414, -0.010006086461747631524400704632178282105, -0.97998782707650473695119859073564343579),
      (0.0059215492758107511385526052767298787739, -0.96837654749802270888209653243226493969, 0.93675309499604541776419306486452987938)
    ]
    data3 = [
      (0.031205145661151929503549831657000846318, -0.9632477752286378160779112088372081634, 0.33395128960373617989264707840742420014, -0.37070351437509836381473586957021603674),
      (0.0080597067440361992367286698217130156564, -0.98172152592538320992689636501802696381, 0.83982431545247212980572119059358474792, -0.85810278952708891987882482557555778411),
      (0.057441173850402680461331283343301712008, -0.6189288210472121331386195006280717197, 0.43044471386290140376795873756746088333, -0.81151589281568927062933923693938916363),
      (0.023345242363151690679154011088673171842, -0.66386270955517128907044482283274107879, 0.62658528209883853982451662602671593723, -0.96272257254366725075407180319397485844),
      (0.062630952569938568823485827212302985766, -0.32209877704944562157081399065909603587, 0.13050532975422842890370386873351257506, -0.80840655270478280733288987807441653919)
    ]
  elseif degree == 16
    data1 = 0.090529132147637585798682804751497905871
    data2 = [
      (0.082185846287397899082859837743846349856, -0.508019859065716531056564440465839641, 0.016039718131433062113128880931679281991),
      (0.081423666624850718504727604609892231433, -0.1688302062291589735580386476319745286, -0.6623395875416820528839227047360509428),
      (0.029563269380448807960364375206438726749, -0.82928886682659935648935022895726939779, 0.65857773365319871297870045791453879558),
      (0.058836819397976195721222704445565411515, -0.67616271161745754624623346597531512883, 0.35232542323491509249246693195063025766),
      (0.0088370926243011378507684635783092181714, -5.3815663675432935238750288859902834282e-109, -1),
      (0.051948666596554316640604583694066880977, -0.049438544908115791823484418930976089946, -0.90112291018376841635303116213804782011)
    ]
    data3 = [
      (0.037876544928831397939092427613418818028, -0.89048965017059377421655257720683258971, 0.50834012288953561570997807325829055003, -0.61785047271894184149342549605145796032),
      (0.0033089334296700963847916278962044308229, -0.95359314446237258192502291745679921363, 0.93648873606191735836919518841625197884, -0.98289559159954477644417227095945276521),
      (0.030017203568571612165136964521714949941, -0.96213644343918817003656945894522367429, 0.29860739649089281625925299156381596948, -0.3364709530517046462226835326185922952),
      (0.015895187866784997621199196218108093516, -0.96193974051260510241812957568503652064, 0.80054740654085925227401383438774365525, -0.83860766602825414985588425870270713461),
      (0.063967220158740137569628123287866229484, -0.79478761952120380739655029677085645407, 0.17829768112849583758057340125685564327, -0.3835100616072920301840231044859991892),
      (0.010782374233697622806764075031711751212, -0.988127299966355460185036064778683968, 0.61324373499879128490286065261412937757, -0.62511643503243582471782458783544540958)
    ]
  elseif degree == 17
    data2 = [
      (0.054621853056204215047557695108059484685, -0.16579311127680159678975416725600076679, -0.66841377744639680642049166548799846641),
      (0.0055477751552752843092249851846592899136, -0.97048901667849209319369164139840939816, 0.94097803335698418638738328279681879631),
      (0.050038901900994715594115060352765454535, -0.068804256762219396208216818306124542516, -0.86239148647556120758356636338775091497),
      (0.052625261176035969912068830347159305457, -0.63928376746725875962831385554123912213, 0.27856753493451751925662771108247824427),
      (0.024918001604610884190500085730827367033, -0.86669187304080614048646650320300230601, 0.73338374608161228097293300640600461202),
      (0.075432474305590560032857611935910459517, -0.42858699512682674399632424251061595821, -0.14282600974634651200735151497876808358)
    ]
    data3 = [
      (0.015956600411859186648565244290131049809, -0.96796471527576140631518537573347042693, 0.6495801403301760488685812163616402457, -0.68161542505441464255339584062816981878),
      (0.044975545093382132884644311560338005954, -0.38743681650762691692938101229025325485, 0.25273806077290452413744460559562465037, -0.86530124426527760720806359330537139552),
      (0.020796879911679072927257130756176547979, -0.97354065447982621338596657330178882606, 0.14258973588936810370129822339191719484, -0.16904908140954189031533165009012836878),
      (0.041115796640909034992011659162843848261, -0.84391531886343515165733825896137376978, 0.50647029187291623779285479822871979869, -0.66255497300948108613551653926734602891),
      (0.017384429002002383137547850880991473289, -0.9737282583319946100667927211400606547, 0.43014451822128492303184924075272604399, -0.45641625988929031296505651961266538929),
      (0.0091686968034717336858992147415592016162, -0.9768496481936387693039157631967710822, 0.83183870659563391675486447827828667924, -0.85498905840199514745094871508151559704),
      (0.052343251870673974514245787611602525856, -0.68498904414626018994477816895259857135, 0.086551159192319548209296799380484667575, -0.40156211504605935826451863042788609622)
    ]
  elseif degree == 18
    data1 = 0.072711470602853332335988402976151320416
    data2 = [
      (0.066608940066780270570831020513249877437, -0.20008874386484753663926775646038722347, -0.59982251227030492672146448707922555305),
      (0.024093295267999420236853581306803869378, -0.024839396850260875373628934599793544657, -0.95032120629947824925274213080041291069),
      (0.037898343013557732052184724503582760819, -0.076380987187101537262574124416325864243, -0.84723802562579692547485175116734827151),
      (0.072950178817887274068289295917294690431, -0.51547059497145607559012153340572104878, 0.030941189942912151180243066811442097565),
      (0.014258652039437941355528309610938991063, -0.92233948782262881057955835940173820882, 0.84467897564525762115911671880347641764),
      (0.033118319904006498336116111979261819383, -0.81610451575671360652823121099663693088, 0.63220903151342721305646242199327386177)
    ]
    data3 = [
      (0.02751923246988441047583904641836977339, -0.90839016828027843774281581498808452091, 0.54074475242935042645861991501168424548, -0.63235458414907198871580410002359972457),
      (0.047563821800305659903183394223175954568, -0.58730148513232413316130962964884514978, 0.3419079703884690263223113955340021876, -0.75460648525614489316100176588515703782),
      (0.0090610690045141307984091089591295584041, -0.99220477793305323492615661731437867596, 0.20083790926851382953172593624080189463, -0.20863313133546059460556931892642321867),
      (0.013680220239214362980455516076649575226, -0.97307596651711002157127978980742349944, 0.7566843789350434355117007033556566479, -0.78360841241793341394042091354823314847),
      (0.035494978204040810232789924461690967346, -0.91947943306018387371123279519490851215, 0.27997618400942918982209258667637955233, -0.36049675094924531611085979148147104018),
      (0.010021321749159443407741271393882052956, -0.98940332962678046939842579820752941279, 0.51785895971039698809029890766872251942, -0.52845563008361651869187310946119310664),
      (0.0024458962539221795584360481949957423674, -0.99890327991591536201516398045062601334, 0.94472145792559133356359726011634553554, -0.9458181780096759715484332796657195222),
      (0.050964350623648878943912767860515151418, -0.75882460967215071364642989357871249414, 0.091837550772389199617388042151854332785, -0.33301294110023848597095814857314183865)
    ]
  elseif degree == 19
    data1 = 0.068938795408024669812026416913714150021
    data2 = [
      (0.014218513195596261075438194944381222518, -0.89495221929758206597048698795512662293, 0.78990443859516413194097397591025324585),
      (0.020643510285888563379375271511299695768, -0.014974649917326261006204672820750524368, -0.97005070016534747798759065435849895126),
      (0.030468702186036599162431617970615364518, -0.77710225335395724709458940859057135024, 0.55420450670791449418917881718114270048),
      (0.045967180053483212460620337545594040128, -0.08161159792091268505961214209837404408, -0.83677680415817462988077571580325191184),
      (0.063075069786309950153050389763287229858, -0.19206055489619760678392498292764093084, -0.61587889020760478643215003414471813831),
      (0.04930382969638170658102716032808733157, -0.64365979043647137831445631799854042799, 0.28731958087294275662891263599708085598),
      (0.0035306455528856953194485177898948363749, -0.97672107763242110615802660011074523649, 0.95344215526484221231605320022149047297),
      (0.063506038732006153941897444999340725061, -0.48967673417278460498250110195791340279, -0.020646531654430790034997796084173194424)
    ]
    data3 = [
      (0.019390968973710091597859466457133882581, -0.73860464746393519086078211530574473521, 0.6603129288005507482114383730999627094, -0.92170828133661555735065625779421797419),
      (0.052692643954781466370362997690064596362, -0.37736474038091749444973870042603089225, 0.11873961144060182831770759671302796842, -0.74137487105968433386796889628699707617),
      (0.006564153103671638511890683462332859992, -0.99586214820679038477978859628118904207, 0.26662658625756826609373531798200113825, -0.27076443805077788131394672170081209618),
      (0.036215889862424900129305127397133399259, -0.85087941079674664292586974917469643186, 0.40800963993208421976175838156331845374, -0.55713022913533757683588863238862202188),
      (0.0058526302069404008122936576981139743993, -0.98998542348529101773301781123483422136, 0.70513390875377839935650663034800986154, -0.71514848526848738162348881911317564017),
      (0.032204325528048216419984026965287582219, -0.91822397760796624772174420894241076741, 0.21016795813741592822569883837786491478, -0.29194398052944968050395462943545414738),
      (0.016911774999072993635042140907181887112, -0.51621084207884086284394200561371723534, 0.48636273791487271949314123346299601262, -0.97015189583603185664919922784927877729),
      (0.0066544027257187765179463625108825701742, -0.87982744935538660401520750808428413826, 0.86027539775361029331257605015603810029, -0.98044794839822368929736854207175396203)
    ]
  elseif degree == 20
    data1 = 0.055640442805812463631566788253898051532
    data2 = [
      (0.05633280523008099012864178412473069936, -0.49084146465332177523029470374523072315, -0.018317070693356449539410592509538553699),
      (0.0031953631642664794478945847330657770722, -0.97804771794320447192070397628224037507, 0.95609543588640894384140795256448075015),
      (0.031320923104298133684407003648894203447, -0.78123280657657080596625505020033275589, 0.56246561315314161193251010040066551178),
      (0.036693851897011657919252854118138043537, -0.62741000451091811445653498388475129105, 0.2548200090218362289130699677695025821),
      (0.037809599732929790747314162640799596721, -0.10889788608815036962555544313157118467, -0.78220422782369926074888911373685763067),
      (0.008645101642662310104692722157806774508, -0.92537823880223061201299256742556755612, 0.85075647760446122402598513485113511224),
      (0.055152202516281836053550890863277393079, -0.21314930436580028264207251299344481704, -0.57370139126839943471585497401311036593),
      (0.028407301213633761967680465924479290382, -0.047508776919001973579296255534818088061, -0.90498244616199605284140748893036382388)
    ]
    data3 = [
      (0.0088115896742339902561312708157853846482, -0.98485843899060694347353308294287690802, 0.66659102367647249434430238008617319241, -0.68173258468586555087076929714329628438),
      (0.023945594315818760080585256144999165493, -0.90687927018467136697246089078946388707, 0.5098430057270950102124174847737658903, -0.60296373554242364323995659398430200323),
      (0.0045194784085034621179235150583929560485, -0.87181882878313187990026866476433962457, 0.86210895356788437332353836160651207109, -0.99029012478475249342326969684217244652),
      (0.034668902268877332248730626058035734221, -0.89002504171402637873154550296837045792, 0.22375540709485139987629530764328543032, -0.3337303653808250211447498046749149724),
      (0.016582846110455430851049450635630476598, -0.8000954074237226892341843533057676038, 0.72336803787297349848896164841146460112, -0.92327263044925080925477729510569699731),
      (0.030890431288396919377481650650853417183, -0.78754559055945991527489139589221510388, 0.35633147577927110921599545999123193124, -0.56878588521981119394110406409901682736),
      (0.01478272600102119191287687445277038169, -0.1599524823675518407071141661054621128, 0.1402893857819467195500916946480886286, -0.9803369034143948788429775285426265158),
      (0.046766982927310947730184310937781849814, -0.36427975232845596804806465673948070356, 0.084663608344856170859761688802646336641, -0.72038385601640020281169703206316563308),
      (0.014312800953830741459725346431171736663, -0.97852557428797782533895087798420844581, 0.41736275144064735566397781689608203229, -0.43883717715266953032502693891187358648)
    ]
  else
    @unreachable
  end

  n = 3 * length(data2) + 6 * length(data3)
  if data1 > 0
    n += 1
  end
  wx = Array{T,2}(undef, n, 3)

  r = 1
  if data1 > 0
    wx[r, 1] = data1
    wx[r, 2] = -1 / 3
    wx[r, 3] = -1 / 3
    r += 1
  end
  for (w, s, t) in data2
    for (x, y) in ((s, t), (t, s), (s, s))
      wx[r, 1] = w
      wx[r, 2] = x
      wx[r, 3] = y
      r += 1
    end
  end
  for (w, s, t, u) in data3
    for (x, y) in ((s, t), (t, s), (s, u), (u, s), (t, u), (u, t))
      wx[r, 1] = w
      wx[r, 2] = x
      wx[r, 3] = y
      r += 1
    end
  end

  _geometric_map_to_01!(wx)
  wx
end

#######
# TET #
#######
function _witherdenvincent_quad_tet(degree; T::Type{<:AbstractFloat}=Float64)
  maxdegree = 10
  if degree > maxdegree
    msg = """\n
    `witherden_vincent` quadrature rule only available up to degree $(maxdegree) on a tetrahedron.
    Use `duffy` instead.
    """
    error(msg)
  end

  data1 = -one(T) # w (-1/2, -1/2, -1/2)
  data2 = Tuple{T,T,T}[] # w (s, s, t) (s, t, s) (t, s, s) (s, s, s)
  data3 = Tuple{T,T,T}[] # w (s, t, t) (t, s, t) (s, s, t) (s, t, s) (t, s, s) (t, t, s)
  data4 = Tuple{T,T,T,T}[] # w (s, t, u) perm (s, t, t) (t, s, t) (t, t, s) (u, t, t) (t, u, t) (t, t, u)

  if degree in (0, 1)
    data1 = 1.3333333333333333333333333333333333333
  elseif degree == 2
    data2 = [
      (0.33333333333333333333333333333333333333, -0.72360679774997896964091736687312762354, 0.17082039324993690892275210061938287063)
    ]
  elseif degree == 3
    data2 = [
      (0.18162379004944980942342872025562069427, -0.34367339496723662642072827083693243093, -0.9689798150982901207378151874892027072),
      (0.15170954328388352390990461307771263906, -0.78390550020314279176487322158837338344, 0.35171650060942837529461966476512015033)
    ]
  elseif degree in (4, 5)
    data2 = [
      (0.15025056762402113439891420311104844508, -0.37822816147339878040530853247308433401, -0.86531551557980365878407440258074699796),
      (0.097990724155149266058280273981770004697, -0.81452949937821754719535217252593878951, 0.44358849813465264158605651757781636853)
    ]
    data3 = [
      (0.05672802770277528858409257082700992237, -0.90899259174870070101623894744132112187, -0.091007408251299298983761052558678878131)
    ]
  elseif degree == 6
    data2 = [
      (0.013436281407094190597350983261249151023, -0.91865208293077729376884110208717988144, 0.75595624879233188130652330626153964433),
      (0.073809575391539629460204370471634688549, -0.35532421971544897931201105847501574951, -0.93402734085365306206396682457495275146),
      (0.053230333677556656132920836743306636618, -0.5707942574816959414223215612274300172, -0.28761722755491217573303531631770994839)
    ]
    data4 = [
      (0.064285714285714285714285714285714285714, 0.20601132958329828273486227812187937257, -0.87267799624996494940152894478854603924, -0.46065533708336838393180438854478729409, -0.87267799624996494940152894478854603924)
    ]
  elseif degree == 7
    data1 = 0.12731371928550779848077124815630184245
    data2 = [
      (0.05643944161328937210171489439806231665, -0.36859770044359440115314000081337702315, -0.89420689866921679654057999755986893056)
    ]
    data3 = [
      (0.04252923711047677324569976544392327613, -0.89902035480320726247389235402687506805, -0.10097964519679273752610764597312493195)
    ]
    data4 = [
      (0.049609507637779495159487414921974827082, 0.15034327517400004696648315404461503933, -0.62233233794799790452713779229082848999, -0.90567859927800423791220756946295805935),
      (0.010814361106537788754804577988128720209, 0.62166048219709712223621075969646478759, -0.95746905491703350802232779700036011785, -0.70672237236303010619155516569574455189)
    ]
  elseif degree == 8
    data2 = [
      (0.035235534544545108539097313565645827902, -0.78409455007557830303561343854585276851, 0.35228365022673490910684031563755830553),
      (0.069375663418318043619861410028472677606, -0.629781024434826859446183999496503797, -0.110656926695519421661448001510488609),
      (0.010033674871386933040967405110292766211, -0.91536691263046543675183591431855057189, 0.74610073789139631025550774295565171568),
      (0.055685043809246530275971813171748834223, -0.37163658175192200927334245312373662702, -0.88509025474423397217997264062879011895)
    ]
    data3 = [
      (0.048374573681745097334959362864457783412, -0.12881734283233958954373367640680593526, -0.87118265716766041045626632359319406474)
    ]
    data4 = [
      (0.0095425371877925775336250150191510735196, 0.43492812685261664658005711425116290088, -0.95713213974573885031100182115353118963, -0.52066384736113894595805347194410052161),
      (0.020604648201280446418040434034344443905, 0.16759475660428881185333950841466005283, -0.59172133224794175913941940243963088242, -0.98415209210840529357450070353539828799)
    ]
  elseif degree == 9
    data1 = 0.07734739854997367644741906257553729918
    data2 = [
      (8.5759042345675186085903030258742437834e-05, -0.99999999876036601109069831529161985423, 0.9999999962810980332720949458748595627),
      (0.030897784616567277310532826869162311937, -0.67845092920947681169601712222921603853, 0.035352787628430435088051366687648115583),
      (0.039417216447239047523644877985518239107, -0.35544695635715805159186380319222134027, -0.93365913092852584522440859042333597919),
      (0.010751973306154910354337519688619045729, -0.90978216330917283407807385501200614331, 0.72934648992751850223422156503601842994)
    ]
    data3 = [
      (0.05084544013826995406889748131136091475, -0.77540690799124790934402070093968875729, -0.22459309200875209065597929906031124271)
    ]
    data4 = [
      (0.011179229597731402927583520512290878612, -0.994890841533917338064711949103255315, -0.082257102495081453456435781598997046246, -0.84059495347591975502241648769875059251),
      (0.013646079136993770600501763121325612648, 0.43670065288414901811354448912928750012, -0.93244825862932284418902737202159413719, -0.57180413562550332973548974508609922574),
      (0.027366554623984184053091789082666607808, -0.93116817884364945982158957577713628669, -0.63271726038014422042206258028726154683, 0.19660269960393790066571473635165938035)
    ]
  elseif degree == 10
    data1 = 0.063199698074694317846318428237401466134
    data2 = [
      (0.035916079989691599737018881339842778615, -0.3754998626096227045403833626263450896, -0.87350041217113188637884991212096473119),
      (0.013158879622391177646076980573564101693, -0.77138069228530769882525760469269910942, 0.31414207685592309647577281407809732827)
    ]
    data4 = [
      (0.015191841626926975498161246507619114195, -0.66902794876077789679101975111094717095, -0.17913852156206901142420431149697662502, -0.97269500811508408036057162589509957901),
      (0.00048259245911900483231983784641134908616, 0.8859775346904097323952611738365015259, -0.98772398235041850430481257350316929785, -0.9105295699895727237856360268301629302),
      (0.034319642640608095038714683012872940214, -0.045619240191439298911787183406185558751, -0.75789963770882114801220999680989894474, -0.43858148439091840506379282297401655176),
      (0.013514495573007723718021960153355702928, 0.18851253896001405132314006877136059652, -0.93444106356711465845055795933535161918, -0.31963041182578473442202415010065735815),
      (0.0087681963693812055566076536006009347954, 0.60235456931668878246228336815716196359, -0.93502943687035390432897012004314760659, -0.73229569557598097380434312807086675041),
      (0.017209381065149320852393906999331987612, 0.2561436909507320213865521444358193313, -0.65004131563212195143010154694337920556, -0.95606105968648811852634905054906092018)
    ]

  else
    @unreachable
  end

  n = 4 * length(data2) + 6 * length(data3) + 12 * length(data4)
  if data1 > 0
    n += 1
  end
  wx = Array{T,2}(undef, n, 4)

  r = 1
  if data1 > 0
    wx[r, 1] = data1
    wx[r, 2] = -1 / 2
    wx[r, 3] = -1 / 2
    wx[r, 4] = -1 / 2
    r += 1
  end
  for (w, s, t) in data2
    for (x, y, z) in ((s, s, t), (s, t, s), (t, s, s), (s, s, s))
      wx[r, 1] = w
      wx[r, 2] = x
      wx[r, 3] = y
      wx[r, 4] = z
      r += 1
    end
  end
  for (w, s, t) in data3
    for (x, y, z) in ((s, t, t), (t, s, t), (s, s, t), (s, t, s), (t, s, s), (t, t, s))
      wx[r, 1] = w
      wx[r, 2] = x
      wx[r, 3] = y
      wx[r, 4] = z
      r += 1
    end
  end
  for (w, s, t, u) in data4
    for (x, y, z) in (
      (s, t, u), (t, u, s), (u, s, t), (u, t, s), (t, s, u), (s, u, t),
      (s, t, t), (t, s, t), (t, t, s), (u, t, t), (t, u, t), (t, t, u)
    )
      wx[r, 1] = w
      wx[r, 2] = x
      wx[r, 3] = y
      wx[r, 4] = z
      r += 1
    end
  end

  _geometric_map_to_01!(wx)
  wx
end

########
# QUAD #
########
function _witherdenvincent_quad_quad(degree; T::Type{<:AbstractFloat}=Float64)
  maxdegree = 21
  if degree > maxdegree
    msg = """\n
    `witherden_vincent` quadrature rule only available up to degree $(maxdegree) on a square.
    Use `tensor_product` instead.
    """
    error(msg)
  end

  data1 = Tuple{T,T}[] # w (±s, 0) (0, ±s)
  data2 = Tuple{T,T}[] # w (±s, ±s)
  data3 = Tuple{T,T,T}[] # w (±s, ±t) (±t, ±s)

  if degree in (0, 1)
    data2 = [
      (4.0, 0.0)
    ]
  elseif degree in (2, 3)
    data2 = [
      (1.0, 0.57735026918962576450914878050195745565)
    ]
  elseif degree in (4, 5)
    data1 = [
      (0.8163265306122448979591836734693877551, 0.68313005106397322554806924536807013272)
    ]
    data2 = [
      (0.1836734693877551020408163265306122449, 0.8819171036881968635005385845464201419)
    ]
  elseif degree in (6, 7)
    data1 = [
      (0.24197530864197530864197530864197530864, 0.92582009977255146156656677658399952253)
    ]
    data2 = [
      (0.23743177469063023421810525931129352533, 0.8059797829185987437078561813507442463),
      (0.52059291666739445713991943204673116603, 0.3805544332083156563791063590863941355)
    ]
  elseif degree in (8, 9)
    data1 = [
      (0.45416396068674902744178724560528503088, 0.48892685697436906957409306022929339497)
    ]
    data2 = [
      (0.042731231865775762580130721539841651755, 0.93965525809683770585757175046316803289),
      (0.21420036092686163194242563430597811641, 0.69088055048634387281488830813840885584)
    ]
    data3 = [
      (0.14445222326030678901782819927444760048, 0.9186204410567222596554701791427794163, 0.3448720253644035761712304181246973037)
    ]
  elseif degree in (10, 11)
    data1 = [
      (0.21740043986871200551566672515052291339, 0.71461782966460591762942382404176367266)
    ]
    data2 = [
      (0.27727410298385108795028691796804462632, 0.27365721017145961383557026431906649027),
      (0.21393363787824810450280500660206134837, 0.63660393221230104405852833198974404207)
    ]
    data3 = [
      (0.044074569114983092054304271154112061776, 0.95163038878403345881049829363696371918, 0.81556543368963841306389865463928759233),
      (0.10162134051961130896131640398557349419, 0.34620720004764544118747320724330043979, 0.93556787148759108135480212161830515337)
    ]
  elseif degree in (12, 13)
    data1 = [
      (0.038128625349852737619351565405684462236, 0.98346133261324557127407851401210794962),
      (0.18453546896980721238582475319389847126, 0.63986141836710976174616715579576307077)
    ]
    data2 = [
      (0.29999334435890964324064310267149902525, 0.0),
      (0.039507140647452433689267407341729599229, 0.91877848807971140189839438297320428483),
      (0.23139851940068538741918311064046319298, 0.37962850518674385579275417103548349005),
      (0.13724209671300348677866127359579016247, 0.69955421651335111029920603284399340644)
    ]
    data3 = [
      (0.033519780050381430279388297868080126418, 0.64359737499661812031249815775600267943, 0.97506888390598351993655206803811094573),
      (0.11357512636435423536938725920919955133, 0.33353988116478310285167199804895857823, 0.86442760926706191157507267741750728791)
    ]
  elseif degree in (14, 15)
    data1 = [
      (0.11493292726352536781596028932541766228, 0.79809898789700709024555173503596148462),
      (0.18168575896727184957040458577073367484, 0.30385302639845975610268178690962703058)
    ]
    data2 = [
      (0.041238483788765811839027639617216599853, 0.88242227010688535992041188667767184542),
      (0.0059337464858392213147614197893498681047, 0.97778979953990269742424689352375866785)
    ]
    data3 = [
      (0.10114914347743242280761079470300175928, 0.80871213581950356724002823901416977471, 0.56721357339659070317865169083903012406),
      (0.14783672163288121847905618360636339726, 0.30465479903705254117098598695333881061, 0.57873619403580651026013939264701051891),
      (0.023273194144673214602574891933463059923, 0.9805048437245319615400269877302555585, 0.6974636319909670187938904551822360596),
      (0.055845482492312018840681162505812880996, 0.26484415587231617710014274826830856062, 0.95574251980951170852387507604700262081)
    ]
  elseif degree in (16, 17)
    data1 = [
      (0.13880437768721992480048871346267772478, 0.54504298720914838787010174782667747048),
      (0.065347823807464912859066688973533173055, 0.91749718821915320817120277758673277115)
    ]
    data2 = [
      (0.14285641962219959571166270516073482911, 0.19255424261404688054827243228978233862),
      (0.036715908485251512466108823252963750875, 0.87132868469544327271341598059215273696),
      (0.086255699638143804540935141271187587589, 0.6943880900895507516564691872484594143),
      (0.13455627321191692494394965878086112148, 0.45768299288315551760664997201644894176),
      (0.0076556334149099368494439596667976876552, 0.96920425609150873396809064886215595774)
    ]
    data3 = [
      (0.10317672478493534779017919278157584697, 0.76208827608019827579179765943659247047, 0.27947776671519215001028373596083402351),
      (0.054826400237291440916675995759834604896, 0.9073943521982236707040505947884667131, 0.54689867041431010640112807851437665884),
      (0.015119810388256861898635715383645346634, 0.76124866643908275965614948240512547767, 0.98378797150154955261318330664974572171),
      (0.020780996655963043308681250790566264232, 0.9870947070447678254568263327892903071, 0.30280748178886139816768835788736238796)
    ]
  elseif degree in (18, 19)
    data1 = [
      (0.097737364692828748243518350785527543045, 0.71434425957279423719800751930789820023),
      (0.13930761292248224570420924010933858068, 0.26567205212096375634521276949089468244),
      (0.034869583491887910002162414690733291135, 0.9644342692579672514758983345396097952)
    ]
    data2 = [
      (0.047804547162795794795004833111469267529, 0.80337972946768500184569945317555062404),
      (0.0016177151779117608109927450603284034943, 0.99216540589713472189744527407633022081),
      (0.017441048034355762464098424359798214084, 0.92944960279960938592453972561789815525)
    ]
    data3 = [
      (0.11772583284005608002278985852480623731, 0.51027825736934335058280520856084337461, 0.26664031459456217566653623598727229551),
      (0.016179577611657849789658841248953982496, 0.39073420577524975124346417118562879486, 0.98789293314173530957079377090965768822),
      (0.082846618983404893940813472711113790502, 0.71716792130974519606308556126612093997, 0.51249187721609765575479280145710018395),
      (0.064989081492596046079059800766815612157, 0.2654400078112959960719970586153501497, 0.86890243415450423858119610210847838329),
      (0.038980552396410534776396621703868595797, 0.62003539869325639760371263809929928256, 0.92630295580712924244748529919286127317),
      (0.0098894009347434843812884009858441317495, 0.80167158471859684259236358940451923912, 0.98844653068397375168746156789890756035)
    ]
  elseif degree in (20, 21)
    data1 = [
      (0.1067941587859403825037542148829566842, 0.47335107435822415202690901838844666219),
      (0.066257208004944385159031059020122440339, 0.83527842975586830160520893009495292054)
    ]
    data2 = [
      (0.13519284035614282527922840385434746149, 0.0),
      (0.11988448364634046970472217835662908028, 0.2573719006072289819053755213317636919),
      (0.0082294612892200088282217117254895783997, 0.96333783211562335381484352624945730322),
      (0.030603640928775651038141155704768806683, 0.86245192537965155140267607631968215083),
      (0.096791791893595210842497711127833756611, 0.49689796251934570364793617005129236026),
      (0.061516341481316561201749944009961586508, 0.70433217519540056955932591780080720749)
    ]
    data3 = [
      (0.086728499513208224903936696999552926752, 0.24187818547670197670997054949192246819, 0.67414621995531773950245618191533516236),
      (0.055879117404127348063047858204117827292, 0.48015696631279513715726389107913072158, 0.82464737527092073827881221191700729562),
      (0.037128827440913817653330718954876960924, 0.93224193592175396207500211941993080129, 0.27069918410166491089101469370373344757),
      (0.028775600851020531767579367626940765984, 0.93490232582401054613354438740771124115, 0.67503956743707526937208896355984125883),
      (0.011509520442493167578261138308188460848, 0.99045546752952415272197458895882111757, 0.48891625117716687937811887553934444444),
      (0.0075284821304016457091249399363317448912, 0.83113524597590138585974389212898407353, 0.98896061138657239166243578378631145048),
      (0.010512304158251076525756742074316914114, 0.091469600922291296668443828573471880948, 0.98401714848959892866013755872564589893)
    ]
  else
    @unreachable
  end

  n = 4 * length(data1) + 8 * length(data3)
  for (_, s) in data2
    n += iszero(s) ? 1 : 4
  end
  wx = Array{T,2}(undef, n, 3)

  r = 1
  for (w, s) in data1
    for (x, y) in ((+s, 0), (-s, 0), (0, +s), (0, -s))
      wx[r, 1] = w
      wx[r, 2] = x
      wx[r, 3] = y
      r += 1
    end
  end
  for (w, s) in data2
    if iszero(s)
      wx[r, 1] = w
      wx[r, 2] = s
      wx[r, 3] = s
      r += 1
    else
      for x in (+s, -s)
        for y in (+s, -s)
          wx[r, 1] = w
          wx[r, 2] = x
          wx[r, 3] = y
          r += 1
        end
      end
    end
  end
  for (w, s, t) in data3
    for (u, v) in ((s, t), (t, s))
      for x in (+u, -u)
        for y in (+v, -v)
          wx[r, 1] = w
          wx[r, 2] = x
          wx[r, 3] = y
          r += 1
        end
      end
    end
  end

  _geometric_map_to_01!(wx)
  wx
end

#######
# HEX #
#######
function _witherdenvincent_quad_hex(degree; T::Type{<:AbstractFloat}=Float64)
  maxdegree = 11
  if degree > maxdegree
    msg = """\n
    `witherden_vincent` quadrature rule only available up to degree $(maxdegree) on a cube.
    Use `tensor_product` instead.
    """
    error(msg)
  end

  data1 = Tuple{T,T}[] # w (±s, 0, 0) (0, ±s, 0) (0, 0, ±s)
  data2 = Tuple{T,T}[] # w (±s, ±s, ±s)
  data3 = Tuple{T,T}[] # w (0, ±s, ±s) (±s, 0, ±s) (±s, ±s, 0)
  data4 = Tuple{T,T,T}[] # w (±t, ±s, ±s) (±s, ±t, ±s) (±s, ±s, ±t)

  if degree in (0, 1)
    data1 = [
      (8.0, 0.0)
    ]
  elseif degree in (2, 3)
    data1 = [
      (1.3333333333333333333333333333333333333, 1.0)
    ]
  elseif degree in (4, 5)
    data1 = [
      (0.88642659279778393351800554016620498615, 0.79582242575422146326454882047613584616)
    ]
    data2 = [
      (0.33518005540166204986149584487534626039, 0.75878691063932814626903427811226742764)
    ]
  elseif degree in (6, 7)
    data1 = [
      (0.20012989098356700695575850638756794678, 0.98808616118867654860459729594655654482)
    ]
    data2 = [
      (0.45715385606985274296912190785204854361, 0.40795516735831936633080916251520586856),
      (0.15379614006595869408326783499527494637, 0.78110282100411850665136814715928740203)
    ]
    data3 = [
      (0.15930172375100887182052758490800036662, 0.84805227568403872779622085759407839383)
    ]
  elseif degree in (8, 9)
    data1 = [
      (0.43327499574965454300983079319432200813, 0.61368146959170899383488488974055688452)
    ]
    data2 = [
      (0.050148795299349029867451487724661687604, 0.87009978466197591761506380886392483306),
      (0.19885983814402350032086871858560920797, 0.56411080702003005426661899866307283066)
    ]
    data3 = [
      (0.091789806136177642171244588919646331302, 0.87768712325767828648677575899433236264)
    ]
    data4 = [
      (0.09611680351337336643247993847150603379, 0.43226790263086216441602486151694383909, 0.93853042186467174532897686960307879508)
    ]
  elseif degree in (10, 11)
    data1 = [
      (0.2024770736128001905853371309670196589, 0.81261433409962649639237559737974432611)
    ]
    data2 = [
      (0.11753834795645628038993180401068212711, 0.60167526419826270163441300578531749659),
      (0.044643912078829241641001154282130043664, 0.85545576101775998467509147069034657598),
      (0.21599204525496912931346666638444131361, 0.31339340451605472104577323055795129941),
    ]
    data3 = [
      (0.14519934586011569829250580079425982305, 0.73466828699700801734638476986754918792),
    ]
    data4 = [
      (0.061441994097835335202750044633046200824, 0.45079993511450943037788434573026952398, 0.96509966551271026293028182312534456821),
      (0.022614296138821884223196230668984478131, 0.94124485721060326391115015763113464139, 0.35390281459663013491031287081289167626)
    ]
  else
    @unreachable
  end

  n = 8 * length(data2) + 12 * length(data3) + 24 * length(data4)
  for (_, s) in data1
    n += iszero(s) ? 1 : 6
  end
  wx = Array{T,2}(undef, n, 4)

  r = 1
  for (w, s) in data1
    if iszero(s)
      wx[r, 1] = w
      wx[r, 2] = s
      wx[r, 3] = s
      wx[r, 4] = s
      r += 1
    else
      for (x, y, z) in ((+s, 0, 0), (-s, 0, 0), (0, +s, 0), (0, -s, 0), (0, 0, +s), (0, 0, -s))
        wx[r, 1] = w
        wx[r, 2] = x
        wx[r, 3] = y
        wx[r, 4] = z
        r += 1
      end
    end
  end
  for (w, s) in data2
    for x in (+s, -s)
      for y in (+s, -s)
        for z in (+s, -s)
          wx[r, 1] = w
          wx[r, 2] = x
          wx[r, 3] = y
          wx[r, 4] = z
          r += 1
        end
      end
    end
  end
  for (w, s) in data3
    for k in 1:3
      for u in (+s, -s)
        for v in (+s, -s)
          wx[r, 1] = w
          wx[r, 1+k] = 0
          wx[r, 1+mod(k, 3)+1] = u
          wx[r, 1+mod(k + 1, 3)+1] = v
          r += 1
        end
      end
    end
  end
  for (w, s, t) in data4
    for k in 1:3
      for t in (+t, -t)
        for u in (+s, -s)
          for v in (+s, -s)
            wx[r, 1] = w
            wx[r, 1+k] = t
            wx[r, 1+mod(k, 3)+1] = u
            wx[r, 1+mod(k + 1, 3)+1] = v
            r += 1
          end
        end
      end
    end
  end

  _geometric_map_to_01!(wx)
  wx
end

#########
# WEDGE #
#########
function _witherdenvincent_quad_wedge(degree; T::Type{<:AbstractFloat}=Float64)
  maxdegree = 10
  if degree > maxdegree
    msg = """\n
    `witherden_vincent` quadrature rule only available up to degree $(maxdegree) on a wedge.
    """
    error(msg)
  end

  # /!\ if z = 0
  data1 = Tuple{T,T}[] # w (-1/3, -1/3, ±z)
  data2 = Tuple{T,T,T,T}[] # w (s, t, ±z) (t, s, ±z), (s, s, ±z)
  data3 = Tuple{T,T,T,T,T}[] # w (s, t, ±z), (t, s, ±z), (s, u, ±z), (u, s, ±z), (t, u, ±z), (u, t, ±z)

  if degree in (0, 1)
    data1 = [
      (4.0, 0.0)
    ]
  elseif degree == 2
    data1 = [
      (0.66666666666666686507594918564641756458, 0.99999999999999985119303811076522004183)
    ]
    data2 = [
      (0.88888888888888875661603387623572162361, -0.74158162379719638007464124598498266439, 0.48316324759439276014928249196996532878, 0.0)
    ]
  elseif degree == 3
    data1 = [
      (0.89998695257960196814387903509173005101, 0.86066920446477793249332885107223920359),
    ]
    data3 = [
      (0.366671015806799343952040321636089983, -0.52223312808684327863699399822724711768, 0.52222829574978345631488370728601281383, -0.99999516766294017767788970905876569615, 0.0)
    ]
  elseif degree == 4
    data1 = [
      (0.43164789926214201915560571539043719684, 0.86686197400903479841583223937151297546),
    ]
    data2 = [
      (0.54565845042191057226153838655080393041, -0.062688380276009575455822705856210492672, -0.87462323944798084908835458828757901466, 0.0),
      (0.24995480836833070748402890159445230251, -0.79851918840217872745314255427215462609, 0.59703837680435745490628510854430925218, 0.67563982368225971739661759355428029031)
    ]
  elseif degree == 5
    data1 = [
      (0.71145555593148684996197343022099556338, 0.0)
    ]
    data2 = [
      (0.22471006722826685202639587426081419504, -0.025400070899508667767082370124706051859, -0.94919985820098266446583525975058789628, 0.0),
      (0.18566142131615813987257487985503458339, -0.10880379065925599247444934872713650457, -0.78239241868148801505110130254572699087, 0.8710029348654440527292590830738210619),
      (0.25007428574779395912056494464439239186, -0.79828210803458293816870337538129563058, 0.59656421606916587633740675076259126116, 0.57042698070515927206196786842334325646)
    ]
  elseif degree == 6
    data1 = [
      (0.22269313409222502250038629788629976598, 0.52662270480497475869798007748379244322),
      (0.13839610937412451172575590081432159364, 0.99083630081924474869286718300205167763),
    ]
    data2 = [
      (0.31182801481333532900066338577135735737, -0.66959346994381506531292392577889361708, 0.33918693988763013062584785155778723416, 0.0),
      (0.050146535238696554002545078611329875622, -0.95905346077548616195214584157965381704, 0.91810692155097232390429168315930763408, 0.0),
      (0.19605056020608216687021916179149498019, -0.067776668819680981202280000599855057023, -0.86444666236063803759543999880028988595, 0.48167413488438751267079566597126764678)
    ]
    data3 = [
      (0.084632875139559356776397936558477141722, -0.59485220654953844609181984939099585377, 0.52549348166744454603903998678937679713, -0.93064127511790609994722013739838094335, 0.80928579325583275231645432806703865787)
    ]
  elseif degree == 7
    data1 = [
      (0.11378272445075715563392222208600913026, 0.98022806959089160171504882914128008603)
    ]
    data2 = [
      (0.024472968692380158977782543188506640362, -0.98332480906795705560590831565479581293, 0.96664961813591411121181663130959162585, 0.0),
      (0.086203456344905850875965416526967283444, -0.036956049341726798726440754485546402356, -0.92608790131654640254711849102890719529, 0.84138735420652599295096060100359489758),
      (0.11671409960839383433248991439345238969, -0.80903350325702126768802840491559333013, 0.61806700651404253537605680983118666027, 0.79584909058698306626909009833843112408)
    ]
    data3 = [
      (0.10205942534059700976786329599159184945, -0.97570173680324342035479366133901540544, 0.48599336414579127066992364784746385989, -0.51029162734254785031512998650844845445, 0.0),
      (0.15576281310483042016174134706586605691, -0.38968756713554786569859973469754143293, -0.69403080315040476305982696739689230156, 0.083718370285952628758426702094433734489, 0.4039345605321099116998238341362959742)
    ]
  elseif degree == 8
    data1 = [
      (0.082939746571421834033180571412028667484, 0.22443386610599057286592461466529935585),
      (0.20435770844872619128158195584935122282, 0.68182544157086581170215168002374039522)
    ]
    data2 = [
      (0.072608995136598867700988758862181257017, -0.89317529812618572284389086719897089711, 0.78635059625237144568778173439794179421, 0.0),
      (0.2107989796260286741645220068699562506, -0.079822074372578761440178266060788079463, -0.84035585125484247711964346787842384107, 0.0),
      (0.084346037174345969123924723988899397111, -0.082861862418097326120000870246452008956, -0.83427627516380534775999825950709598209, 0.87619591000025424474025327234232345955),
      (0.16251705063595730345650668876189645828, -0.65187678415125922476703025933216051413, 0.30375356830251844953406051866432102826, 0.40608422935459024220472507696440370377),
      (0.028581431014154463281085418946775972209, -0.90552242832046124932977560924577476395, 0.8110448566409224986595512184915495279, 0.82881544305868020493486275746014093078),
      (0.044572109393861233332081245114974812183, -0.68050147211482206696479393170526142918, 0.36100294422964413392958786341052285835, 0.96586516654065435448682371732369762245)
    ]
    data3 = [
      (0.054590116363492292384362848950462321489, -0.4743723986175179830847346899909858658, 0.45719614360199995718682043629988661246, -0.98282374498448197410208574630890074666, 0.57735026918962576450914878050195745565)
    ]
  elseif degree == 9
    data1 = [
      (0.19114798844620108508537046584425003736, 0.0)
      (0.1060969195893273614653564550346218398, 0.87583915879987761660772171906042408394)
    ]
    data2 = [
      (0.049462405441895223670279761487537762472, -0.0010699296586281549894456411507705393926, -0.99786014068274369002110871769845892121, 0.0),
      (0.15080793261275860374457825128943921743, -0.10986499991499267966311447997302837166, -0.78027000017001464067377104005394325668, 0.52963355520607675696300739352733925666),
      (0.09338246974553840864616210022748459774, -0.57769113257897895683607913964943464903, 0.15538226515795791367215827929886929806, 0.32397688216877005165250824998597314548),
      (0.03838828638520642757038156568015552951, -0.91231503711701435232450671034134809014, 0.82463007423402870464901342068269618029, 0.40165166857078872104499428459378049449),
      (0.026528431202320433845464036710085263608, -0.03450013665826621486161695118676603904, -0.93099972668346757027676609762646792192, -0.9677921254642105035410819146400981344),
      (0.066719942573448407007300296577585702464, -0.6456435117766454460710959796587760834, 0.29128702355329089214219195931755216681, 0.89078174045697066578383528302064143989),
      (0.012131173836407148944270419030858660558, -0.90753763917811234690103494985844043039, 0.81507527835622469380206989971688086078, 0.9577062038929269606887790227035291939)
    ]
    data3 = [
      (0.087691161312839084087580790508946261895, -0.88126598051326876444819587362986475675, 0.44939053910599895722040631866985064464, -0.56812455859273019277221044503998588789, 0.0),
      (0.0495312141698622864915543816230467997, -0.5517449084932878730050536869300298641, 0.49681091913207739922639584227322548803, -0.94506601063878952622134215534319562393, 0.69522055387163478698981196744187399375)
    ]
  elseif degree == 10
    data1 = [
      (0.038043108084240763009572271119163370293, 1.0),
      (0.12804920643255787761445727849451714328, 0.2838364013985715684657060577249329797)
    ]
    data2 = [
      (0.045423158480136973856219994221831113886, -0.58509925002156576804484663776694671178, 0.17019850004313153608969327553389342357, 0.0),
      (0.12078661810034629566292168130821741978, -0.087745274263836468012344092631834458624, -0.82450945147232706397531181473633108275, 0.0),
      (0.070523638001611290833549221721909796384, -0.83336149569989450879622615827585222698, 0.66672299139978901759245231655170445397, 0.0),
      (0.10435318130434033235265655019864541098, -0.58566729572033783230931886738991607412, 0.17133459144067566461863773477983214824, 0.47829026090036813970247985116366265217),
      (0.045353049770314160210925207718221960406, -0.71401760691431835996629386931253079667, 0.42803521382863671993258773862506159333, 0.8520666639991396363392553699935906628),
      (0.028126573654953943549801873601641305154, -0.0059182255205082649355625415633530872236, -0.98816354895898347012887491687329382555, 0.62749011164795345095028595959683589121),
      (0.09730006751474251906683045094709204535, -0.14443508029301579714242731927948333445, -0.71112983941396840571514536144103333111, 0.76897188255294104672722599221030791768),
      (0.0075697428403356175236518069263715176348, -0.92655062106089238633040808286062465799, 0.85310124212178477266081616572124931598, 0.94536185592175700771401046143327478453),
    ]
    data3 = [
      (0.0031208636401827010315915455956052660089, -0.99621476080190120325860648054065438352, 0.99582008190465265332555390082623777504, -0.99960532110275145006694742028558339152, 0.0),
      (0.024183540649806648348002441154357646858, -0.91342063244101618001407082339238449491, 0.3255064864791910018042153093720481789, -0.41208585403817482179014448597966368399, 0.94236346745083749482627300953387466221),
      (0.05460310873669147926531122821390556603, -0.9234169616555928413056660388640430162, 0.37513146835671456389900781390965761438, -0.45171450670112172259334177504561459817, 0.33533610866739435446116498131265141599),
      (0.024769538519410488660113297222678366236, -0.96792121274553310722108842071500064645, 0.74052721727873797554079834546410281777, -0.77260600453320486831970992474910217133, 0.61432350187707741015732547519719343903)
    ]
  else
    @unreachable
  end

  n = 0
  for (_, z) in data1
    n += iszero(z) ? 1 : 2
  end
  for (_, _, _, z) in data2
    n += iszero(z) ? 3 : 6
  end
  for (_, _, _, _, z) in data3
    n += iszero(z) ? 6 : 12
  end
  wx = Array{T,2}(undef, n, 4)

  r = 1
  for (w, z) in data1
    zs = iszero(z) ? (z,) : (+z, -z)
    for z in zs
      wx[r, 1] = w
      wx[r, 2] = -1 / 3
      wx[r, 3] = -1 / 3
      wx[r, 4] = z
      r += 1
    end
  end
  for (w, s, t, z) in data2
    zs = iszero(z) ? (z,) : (+z, -z)
    for (x, y) in ((s, t), (t, s), (s, s))
      for z in zs
        wx[r, 1] = w
        wx[r, 2] = x
        wx[r, 3] = y
        wx[r, 4] = z
        r += 1
      end
    end
  end
  for (w, s, t, u, z) in data3
    zs = iszero(z) ? (z,) : (+z, -z)
    for (x, y) in ((s, t), (t, s), (s, u), (u, s), (t, u), (u, t))
      for z in zs
        wx[r, 1] = w
        wx[r, 2] = x
        wx[r, 3] = y
        wx[r, 4] = z
        r += 1
      end
    end
  end

  _geometric_map_to_01!(wx)
  wx
end

###########
# PYRAMID #
###########
function _witherdenvincent_quad_pyramid(degree; T::Type{<:AbstractFloat}=Float64)
  maxdegree = 10
  if degree > maxdegree
    msg = """\n
    `witherden_vincent` quadrature rule only available up to degree $(maxdegree) on a pyramid.
    """
    error(msg)
  end

  data1 = Tuple{T,T}[] # w (0, 0, z)
  data2 = Tuple{T,T,T}[] # (±t, 0, z) (0, ±t, z)
  data3 = Tuple{T,T,T}[] # w (±t, ±t, z)
  data4 = Tuple{T,T,T,T}[] # w (±s, ±t, z) (±t, ±s, z)

  if degree in (0, 1)
    data1 = [
      (2.6666666666666666666666666666666666667, -0.5)
    ]
  elseif degree == 2
    data1 = [
      (0.60287280353093925911579186632475611728, 0.21658207711955775339238838942231815011)
    ]
    data2 = [
      (0.51594846578393185188771870008547763735, 0.71892105581179616210276971993495767914, -0.70932703285428855378369530000365161136)
    ]
  elseif degree == 3
    data1 = [
      (0.67254902379402809443607078852738472107, 0.14285714077213670617734974746312582074),
      (0.30000001617617323518941867705084375434, -0.99999998864829993678698817507850804299)
    ]
    data3 = [
      (0.42352940667411633426029430027210954782, 0.56108361105873963414196154191891982155, -0.66666666666666666666666666666666666667)
    ]
  elseif degree == 4
    data1 = [
      (0.30331168845504517111391728481208001144, 0.35446557777227471722730849524904581806),
      (0.55168907357213937275730716433358729608, -0.74972609378250711033655604388057044149)
    ]
    data2 = [
      (0.28353223437153468006819777082540613962, 0.6505815563982325146829577797417295398, -0.35523170084357268589593075201816127231)
    ]
    data3 = [
      (0.16938424178833585063066278355484370017, 0.65796699712169008954533549931479427127, -0.92150343220236930457646242598412224897)
    ]
  elseif degree == 5
    data1 = [
      (0.18249431975770692138374895897213800931, 0.45971576156501338586164265377920811314),
      (0.45172563864726406056400285032640105704, -0.39919795837246198593385139590712322914),
      (0.15654542887619877154120304977336547704, -0.99999998701645569241460017355590234925)
    ]
    data2 = [
      (0.20384344839498724639142514342645843799, 0.70652603154632457420722562974792066862, -0.75)
    ]
    data3 = [
      (0.10578907087905457654220386143818487109, 0.70511712277882760181079385797948261057, -0.87777618587595407108464357252416911085),
      (0.15934280057233240536079894703404722173, 0.43288286410354097685000790909815143591, -0.15279732576055038842025517341026975071)
    ]
  elseif degree == 6
    data1 = [
      (0.067901049767045421348323914977088073991, 0.61529159538791884731954955103613269638),
      (0.042809368467176804517723726702995063594, -0.99647238229436073479434618269377000101),
      (0.31887881187339684620076177026181758884, -0.72347438707253884945296925394581802655),
      (0.27482845386440493216991697942238502071, -0.15715217612872593659809486760257994179)
    ]
    data2 = [
      (0.09853490116354529166000184266852321827, 0.83459535111470834854355609376418165506, -0.80510531794907605316224881154681003606),
      (0.084233545301795354894729459206933067324, 0.4339254093766990953588290760534534212, 0.13214918124660180928234184789309315759)
    ]
    data3 = [
      (0.099200345038528745418340651788127467643, 0.565680854425675497672813848515505886, -0.94104453830855858213371584535608020131),
      (0.19701969247180494546144986676345270691, 0.49807909178070594245642503041316019049, -0.47016827357574098280216051103358470857),
      (0.011573761697986328172963248398558769736, 0.95089948721448243656573347456644144515, -0.90350185873612803037779492533363294921)
    ]
  elseif degree == 7
    data1 = [
      (0.066668205424525275886791453990965274088, -0.99990903958359448324157651569821071245),
      (0.26808048719971487350508383578016326765, -0.21283424648469159495743047454829830674),
      (0.041885798472046210460725670120584684749, 0.67736556563370307561404794332413479832)
    ]
    data2 = [
      (0.071178024781341107871720116618075801749, 0.86409875978771469746212899147839955436, -0.86666666666666666666666666666666666667),
      (0.0765625, 0.61721339984836764104437785105599968169, -0.33333333333333333333333333333333333333)
    ]
    data3 = [
      (0.17589383239993943496133030969806235827, 0.35415238086811614472192282023591880504, -0.74142718092090097274899859132692797362),
      (0.039429701216628418845191891303832420129, 0.80272585010008780509805139967826527905, -0.8397229396404438938817746892937556123),
      (0.078717625851263666944851563183733367932, 0.25413534686185723866998548790851960044, 0.21103986022119982736889633047207386205),
      (0.035476919918997616432307229513622918413, 0.61430510772078528251050043488178085003, -0.99999999982048339801908931464259502541),
      (0.095249439724424831648115316376411493553, 0.52483269825437554768220460074528261831, -0.41891384901080493632836824125506837378)
    ]
  elseif degree == 8
    data1 = [
      (0.13184265374874503915150962831580955798, 0.16961086821625198841160807357430296303),
      (0.23294583850972276008807786158154187047, -0.45709920916162097942096244184174038575),
      (0.1025615399916185433427056721703912695, -0.8571191395690919692972040925801237448)
    ]
    data2 = [
      (0.025002825067006628763387217678722243502, 0.79609608877425818401350057240825839617, -0.99999998535272208389601372955851209324),
      (0.043496051243830853021390765401449212594, 0.56488895874183987384568871426044651743, -0.15563259879788280847417645674822833541),
      (0.085972592189522311083702670388617702554, 0.75302269354894756094500969219941272468, -0.70447200540690062790548707515722730722)
    ]
    data3 = [
      (0.033693598991694192959947383133729992714, 0.24657794246228701631399967234303066604, 0.34690569585096941192869185686421558358),
      (0.016574786736306812829168423699380538904, 0.733889532546736034455005667208354524, -0.50885838992749887300910718599394991577),
      (0.0069686742230647669915684670235521865055, 8.2682671512759671070733214668120998744e-05, 0.71650072530116328406253461877461140784),
      (0.078199915186776001276629590295086773482, 0.39899655709522770213204971246835352882, -0.905193536761024932000392660301831356),
      (0.09695835803779916324529325757517456104, 0.36531241447958999003326854299025213837, -0.19562858755898781208157405487726925012),
      (0.10928549585578987401418986532517092138, 0.48342524404083818448316048507452071227, -0.6193703578271817921429725882760024584)
    ]
    data4 = [
      (0.026838430536177238417907867814423429749, 0.63140479760056088062582891340019355538, 0.89485619649153056248689063682197549292, -0.90904839155249779567018573275816306293)
    ]
  elseif degree == 9
    data1 = [
      (0.085460984360913357764893933078028332729, -0.92570813813698889109129119190081512807),
      (0.063448589186874929695131357848153481143, 0.38840052634065219135681708305790886389)
    ]
    data2 = [
      (0.011128992807985123067277549928909458533, 0.92582009586084253032799389643931359042, -0.99999999154974290966555556001355192819),
      (0.059450110292314583119663538852454940094, 0.67609699211636384672984868113196489501, -0.46053643095988580287931352750197363634),
      (0.0776747274078750789822277466474486484, 0.61633217785092524266810713694367497984, -0.83333333333333333333333333333333333333),
      (0.030778150795469403052702032209364808496, 0.4319711692851802893108753357781180147, 0.066835620891566889973434395390065117459)
    ]
    data3 = [
      (0.026934866206292627452016019156950031128, 0.2418018136307698645699176701173330115, 0.32397601743070136249634461603450683373),
      (0.0054906085371215318653035688791270966898, 0.84407916290318983449502858785742636196, -0.69559058038907269643252446934200271874),
      (0.091321836708580883183025234669307589456, 0.22796693876082527450191978423554002258, -0.15546892682110902998061305430650131847),
      (0.034425103045059116731460865162898501905, 0.50278497713501010732851661733402034476, -0.20647126020221948473530582466409396899),
      (0.098966083060889195749931548220643079817, 0.26050107498343109780824156599994159958, -0.59835855612565852733392737890318400229),
      (0.0059165284766696216483252319063621153113, 0.092695873086724294634409475285537266946, 0.73229074155927557470203809617847092006),
      (0.042549891029853590361699211197576823164, 0.48321616807064450811403139613908012977, -0.96099197501517696963244605665802872457),
      (0.061512848339540276373149763598941694174, 0.56718550560823240035320376398524873163, -0.57366279658687978481813471518028589696),
      (0.01226506819386170482790970630106848162, 0.84639499151387610363269282068500210562, -0.9693044055039805656571133868955522239),
    ]
    data4 = [
      (0.035512229189103429193484163602033972206, 0.84717786811774533056315715378413225505, 0.4641907129661462762986126522881287914, -0.83333333333333333333333333333333333333),
    ]
  elseif degree == 10
    data1 = [
      (0.0064032713667237888900352396740754404729, 0.8335915635582545504216363089082427512),
      (0.12510914109270313689497865562091419825, -0.29772638731929483125782053014294599572),
      (0.026257761996077744884993081945201819617, 0.48382713592659987946255767367350514622)
    ]
    data2 = [
      (0.015139712847816799484708864305781950367, 0.9211301560146403583275192188149101662, -0.87367680544017104618678473155554592542),
      (0.10992335931150491339794381086452639803, 0.45469488442525374190737620014752106622, -0.64653917767653518703751426296454346724),
      (0.024556675381417956733986284061921577306, 0.34954698449670665618703426052652270092, 0.20418762141582796229356027682309379013),
    ]
    data3 = [
      (0.018849056440184169335496436007427270559, 0.4036909359989290549941040384972850952, 0.054098939536306234614681587161827868581),
      (0.079548495536999982380261599863958558798, 0.37146089090647414146733508749634017582, -0.30177911620290173994768222380627364654),
      (0.015653314138178086543067828035606638277, 0.29959799664341220986603563452809915211, -0.98613205424907319746460559817869321699),
      (0.01321164115938370158671751695816318467, 0.15822625455417853696460187646671225705, 0.55052863586639312904708979516957590328),
      (0.04248249939111569201880871313257692538, 0.18199793495199664689817847929133993856, 0.094130036292678266102175169411106014378),
      (0.013577406627154434615745463141085805356, 0.84558414980124129459537713613832697939, -0.85420317704867900916510706229135574932),
      (0.018255448920823418809917141458083463367, 0.64686940593734291264486164508395007448, -0.4327553204044903896084514899827863369),
      (0.040101387680976965655189913433625764305, 0.58758702940872080235172874857818290802, -0.88037395641454691452237186705157604445),
      (0.041640434996784578197489213844819716323, 0.22376205998381611725842742973864304392, -0.86833824003875333700960736566405613663),
    ]
    data4 = [
      (0.023758293511727935483135714858684359226, 0.74556570846972106998428795431576226847, 0.22471743188490617098996468276780795745, -0.94549948945065210679473240922421954622),
      (0.044777923892939049214710728242065071131, 0.40566195273187711340899110766544318165, 0.74872676280187880094043851032586166563, -0.67639997414589843421870375009684158879),
      (0.02188199761414342991806676205008653974, 0.070742568281209621329314096569945291862, 0.60045691112687358169539106741319911554, -0.28305887282189848782440087097630180014),
      (0.006724130291414485504002863473684804576, 0.94221914707966808645220493887337761891, 0.63756310407853872036884558065034515453, -0.98511871784623050002484940519580993686)
    ]
  else
    @unreachable
  end

  n = length(data1) + 4 * length(data2) + 4 * length(data3) + 8 * length(data4)
  wx = Array{T,2}(undef, n, 4)

  r = 1
  for (w, z) in data1
    wx[r, 1] = w
    wx[r, 2] = 0
    wx[r, 3] = 0
    wx[r, 4] = z
    r += 1
  end
  for (w, t, z) in data2
    for (x, y) in ((+t, 0), (-t, 0), (0, +t), (0, -t))
      wx[r, 1] = w
      wx[r, 2] = x
      wx[r, 3] = y
      wx[r, 4] = z
      r += 1
    end
  end
  for (w, t, z) in data3
    for (x, y) in ((+t, +t), (+t, -t), (-t, +t), (-t, -t))
      wx[r, 1] = w
      wx[r, 2] = x
      wx[r, 3] = y
      wx[r, 4] = z
      r += 1
    end
  end
  for (w, s, t, z) in data4
    for (u, v) in ((s, t), (t, s))
      for (x, y) in ((+u, +v), (+u, -v), (-u, +v), (-u, -v))
        wx[r, 1] = w
        wx[r, 2] = x
        wx[r, 3] = y
        wx[r, 4] = z
        r += 1
      end
    end
  end

  _geometric_map_to_01!(wx)
  # Map the pyramid with base the unit square and apex (1/2, 1/2, 1) to the pyramid
  # with the same base and apex (0, 0, 1). The measures are the same.
  # This corresponds to the linear map (x, y, z) -> (x-z/2, y-z/2, z)
  for i in axes(wx, 1)
    wx[i, 2] -= wx[i, 4] / 2
    wx[i, 3] -= wx[i, 4] / 2
  end

  wx
end

#########
# Utils #
#########
function _geometric_map_to_01!(wx)
  D = size(wx, 2)
  for i in axes(wx, 1)
    wx[i, 1] /= 2
    for d in 2:D
      wx[i, d] = (wx[i, d] + 1) / 2
    end
  end
  wx
end
