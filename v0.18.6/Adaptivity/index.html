<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Gridap.Adaptivity · Gridap.jl</title><meta name="title" content="Gridap.Adaptivity · Gridap.jl"/><meta property="og:title" content="Gridap.Adaptivity · Gridap.jl"/><meta property="twitter:title" content="Gridap.Adaptivity · Gridap.jl"/><meta name="description" content="Documentation for Gridap.jl."/><meta property="og:description" content="Documentation for Gridap.jl."/><meta property="twitter:description" content="Documentation for Gridap.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Gridap.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Gridap.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../getting-started/">Getting Started</a></li><li><a class="tocitem" href="../Gridap/">Gridap</a></li><li><a class="tocitem" href="../Helpers/">Gridap.Helpers</a></li><li><a class="tocitem" href="../Io/">Gridap.Io</a></li><li><a class="tocitem" href="../Algebra/">Gridap.Algebra</a></li><li><a class="tocitem" href="../Arrays/">Gridap.Arrays</a></li><li><a class="tocitem" href="../TensorValues/">Gridap.TensorValues</a></li><li><a class="tocitem" href="../Fields/">Gridap.Fields</a></li><li><a class="tocitem" href="../Polynomials/">Gridap.Polynomials</a></li><li><a class="tocitem" href="../ReferenceFEs/">Gridap.ReferenceFEs</a></li><li><a class="tocitem" href="../Geometry/">Gridap.Geometry</a></li><li><a class="tocitem" href="../CellData/">Gridap.CellData</a></li><li><a class="tocitem" href="../Visualization/">Gridap.Visualization</a></li><li><a class="tocitem" href="../FESpaces/">Gridap.FESpaces</a></li><li><a class="tocitem" href="../MultiField/">Gridap.MultiField</a></li><li><a class="tocitem" href="../ODEs/">Gridap.ODEs</a></li><li class="is-active"><a class="tocitem" href>Gridap.Adaptivity</a><ul class="internal"><li><a class="tocitem" href="#Interface"><span>Interface</span></a></li><li><a class="tocitem" href="#Edge-Based-refinement"><span>Edge-Based refinement</span></a></li><li><a class="tocitem" href="#CartesianDiscreteModel-refining"><span>CartesianDiscreteModel refining</span></a></li><li><a class="tocitem" href="#Notes-for-users"><span>Notes for users</span></a></li><li><a class="tocitem" href="#Notes-for-developers"><span>Notes for developers</span></a></li></ul></li><li><span class="tocitem">Developper notes</span><ul><li><a class="tocitem" href="../dev-notes/block-assemblers/">Block Assemblers</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Gridap.Adaptivity</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Gridap.Adaptivity</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/gridap/Gridap.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/gridap/Gridap.jl/blob/master/docs/src/Adaptivity.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Gridap.Adaptivity"><a class="docs-heading-anchor" href="#Gridap.Adaptivity">Gridap.Adaptivity</a><a id="Gridap.Adaptivity-1"></a><a class="docs-heading-anchor-permalink" href="#Gridap.Adaptivity" title="Permalink"></a></h1><p>The adaptivity module provides a framework to work with adapted (refined/coarsened/mixed) meshes.</p><p>It provides</p><ul><li>A generic interface to represent adapted meshes and a set of tools to work with Finite Element spaces defined on them. In particular, moving <code>CellFields</code> between parent and child meshes.</li><li>Particular implementations for conformally refining/coarsening 2D/3D meshes using several well-known strategies. In particular, Red-Green refinement and longest-edge bisection.</li></ul><h2 id="Interface"><a class="docs-heading-anchor" href="#Interface">Interface</a><a id="Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Interface" title="Permalink"></a></h2><p>The following types are defined in the module:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Gridap.Adaptivity.RefinementRule" href="#Gridap.Adaptivity.RefinementRule"><code>Gridap.Adaptivity.RefinementRule</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Structure representing the map between a single parent cell and its children.</p><p>Contains: </p><ul><li>T :: <code>RefinementRuleType</code>, indicating the refinement method.</li><li>poly :: <code>Polytope</code>, representing the geometry of the parent cell.</li><li>ref_grid :: <code>DiscreteModel</code> defined on <code>poly</code>, giving the parent-to-children cell map. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gridap/Gridap.jl/blob/967571175f5a9c3b4a3d9ee320e3f2da817bf4cd/src/Adaptivity/RefinementRules.jl#L6-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Gridap.Adaptivity.AdaptivityGlue" href="#Gridap.Adaptivity.AdaptivityGlue"><code>Gridap.Adaptivity.AdaptivityGlue</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Glue containing the map between two nested triangulations. The contained datastructures will  depend on the type of glue. There are two types of <code>AdaptivityGlue</code>: </p><ul><li><code>RefinementGlue</code> :: All cells in the new mesh are children of cells in the old mesh. I.e given  a new cell, it is possible to find a single old cell containing it (the new cell might be exactly the old cell if no refinement).</li><li><code>MixedGlue</code> :: Some cells in the new mesh are children of cells in the old mesh, while others are parents of cells in the old mesh. </li></ul><p>Contains: </p><ul><li><code>n2o_faces_map</code> :: Given a new face gid, returns<ul><li>if fine, the gid of the old face containing it.</li><li>if coarse, the gids of its children (in child order)</li></ul></li><li><code>n2o_cell_to_child_id</code> :: Given a new cell gid, returns <ul><li>if fine, the local child id within the (old) coarse cell containing it.</li><li>if coarse, a list of local child ids of the (old) cells containing it.</li></ul></li><li><code>refinement_rules</code> :: Array conatining the <code>RefinementRule</code> used for each coarse cell.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gridap/Gridap.jl/blob/967571175f5a9c3b4a3d9ee320e3f2da817bf4cd/src/Adaptivity/AdaptivityGlues.jl#L6-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Gridap.Adaptivity.AdaptedDiscreteModel" href="#Gridap.Adaptivity.AdaptedDiscreteModel"><code>Gridap.Adaptivity.AdaptedDiscreteModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>DiscreteModel</code> created by refining/coarsening another <code>DiscreteModel</code>.</p><p>The refinement/coarsening hierarchy can be traced backwards by following the   <code>parent</code> pointer chain. This allows the transfer of dofs   between <code>FESpaces</code> defined on this model and its ancestors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gridap/Gridap.jl/blob/967571175f5a9c3b4a3d9ee320e3f2da817bf4cd/src/Adaptivity/AdaptedDiscreteModels.jl#L2-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Gridap.Adaptivity.AdaptedTriangulation" href="#Gridap.Adaptivity.AdaptedTriangulation"><code>Gridap.Adaptivity.AdaptedTriangulation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Triangulation produced from an AdaptedDiscreteModel.</p><p>Contains: </p><ul><li>adapted_model :: <code>AdaptedDiscreteModel</code> for the triangulation.</li><li>trian :: <code>Triangulation</code> extracted from the background model, i.e <code>get_model(adapted_model)</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gridap/Gridap.jl/blob/967571175f5a9c3b4a3d9ee320e3f2da817bf4cd/src/Adaptivity/AdaptedTriangulations.jl#L2-L10">source</a></section></article><p>The high-level interface is provided by the following methods:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Gridap.Adaptivity.refine" href="#Gridap.Adaptivity.refine"><code>Gridap.Adaptivity.refine</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>function refine(model::DiscreteModel,args...;kwargs...) :: AdaptedDiscreteModel</p><p>Returns an <code>AdaptedDiscreteModel</code> that is the result of refining the given <code>DiscreteModel</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gridap/Gridap.jl/blob/967571175f5a9c3b4a3d9ee320e3f2da817bf4cd/src/Adaptivity/AdaptedDiscreteModels.jl#L54-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Gridap.Adaptivity.coarsen" href="#Gridap.Adaptivity.coarsen"><code>Gridap.Adaptivity.coarsen</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>function coarsen(model::DiscreteModel,args...;kwargs...) :: AdaptedDiscreteModel</p><p>Returns an <code>AdaptedDiscreteModel</code> that is the result of coarsening the given <code>DiscreteModel</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gridap/Gridap.jl/blob/967571175f5a9c3b4a3d9ee320e3f2da817bf4cd/src/Adaptivity/AdaptedDiscreteModels.jl#L68-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Gridap.Adaptivity.adapt" href="#Gridap.Adaptivity.adapt"><code>Gridap.Adaptivity.adapt</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>function adapt(model::DiscreteModel,args...;kwargs...) :: AdaptedDiscreteModel</p><p>Returns an <code>AdaptedDiscreteModel</code> that is the result of adapting (mixed coarsening and refining)   the given <code>DiscreteModel</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gridap/Gridap.jl/blob/967571175f5a9c3b4a3d9ee320e3f2da817bf4cd/src/Adaptivity/AdaptedDiscreteModels.jl#L77-L82">source</a></section></article><h2 id="Edge-Based-refinement"><a class="docs-heading-anchor" href="#Edge-Based-refinement">Edge-Based refinement</a><a id="Edge-Based-refinement-1"></a><a class="docs-heading-anchor-permalink" href="#Edge-Based-refinement" title="Permalink"></a></h2><p>The module provides a <code>refine</code> method for <code>UnstructuredDiscreteModel</code>. The method takes a string <code>refinement_method</code> that determines the refinement strategy to be used. The following strategies are available:</p><ul><li><code>&quot;red_green&quot;</code> :: Red-Green refinement, default.</li><li><code>&quot;nvb&quot;</code> :: Longest-edge bisection (only for meshes of TRIangles)</li></ul><p>Additionally, the method takes a kwarg <code>cells_to_refine</code> that determines which cells will be refined. Possible input types are:</p><ul><li><code>Nothing</code> :: All cells get refined.</li><li><code>AbstractArray{&lt;:Bool}</code> of size <code>num_cells(model)</code> :: Only cells such that <code>cells_to_refine[iC] == true</code> get refined.</li><li><code>AbstractArray{&lt;:Integer}</code> :: Cells for which <code>gid ∈ cells_to_refine</code> get refined</li></ul><p>The algorithms try to respect the <code>cells_to_refine</code> input as much as possible, but some additional cells might get refined in order to guarantee that the mesh remains conforming.</p><pre><code class="language-julia hljs">  function refine(model::UnstructuredDiscreteModel;refinement_method=&quot;red_green&quot;,kwargs...)
    [...]
  end</code></pre><h2 id="CartesianDiscreteModel-refining"><a class="docs-heading-anchor" href="#CartesianDiscreteModel-refining">CartesianDiscreteModel refining</a><a id="CartesianDiscreteModel-refining-1"></a><a class="docs-heading-anchor-permalink" href="#CartesianDiscreteModel-refining" title="Permalink"></a></h2><p>The module provides a <code>refine</code> method for <code>CartesianDiscreteModel</code>. The method takes a <code>Tuple</code> of size <code>Dc</code> (the dimension of the model cells) that will determine how many times cells will be refined in each direction. For example, for a 2D model, <code>refine(model,(2,3))</code> will refine each QUAD cell into a 2x3 grid of cells.</p><pre><code class="language-julia hljs">  function refine(model::CartesianDiscreteModel{Dc}, cell_partition::Tuple) where Dc
    [...]
  end</code></pre><h2 id="Notes-for-users"><a class="docs-heading-anchor" href="#Notes-for-users">Notes for users</a><a id="Notes-for-users-1"></a><a class="docs-heading-anchor-permalink" href="#Notes-for-users" title="Permalink"></a></h2><p>Most of the tools provided by this module are showcased in the tests of the module itself, as well as the following tutorial (coming soon).</p><p>However, we want to stress a couple of key performance-critical points:</p><ul><li><p>The refining/coarsening routines are not optimized for performance. In particular, they are not parallelized. If you require an optimized/parallel implementation, please consider leveraging specialised meshing libraries. For instance, we provide an implementation of <code>refine/coarsen</code> using P4est in the <a href="https://github.com/gridap/GridapP4est.jl">GridapP4est.jl</a> library.</p></li><li><p>Although the toolbox allows you to evaluate <code>CellFields</code> defined on both fine/coarse meshes on their parent/children mesh, both directions of evaluation are not equivalent. As a user, you should always try to evaluate/integrate on the finest mesh for maximal performance. Evaluating a fine <code>CellField</code> on a coarse mesh relies on local tree searches, and is therefore a very expensive operation that should be avoided whenever possible.</p></li></ul><h2 id="Notes-for-developers"><a class="docs-heading-anchor" href="#Notes-for-developers">Notes for developers</a><a id="Notes-for-developers-1"></a><a class="docs-heading-anchor-permalink" href="#Notes-for-developers" title="Permalink"></a></h2><h3 id="RefinementRule-API"><a class="docs-heading-anchor" href="#RefinementRule-API">RefinementRule API</a><a id="RefinementRule-API-1"></a><a class="docs-heading-anchor-permalink" href="#RefinementRule-API" title="Permalink"></a></h3><p>Given a <code>RefinementRule</code>, the library provides a set of methods to compute the mappings between parent (coarse) face ids and child (fine) face ids (and vice-versa). The ids are local to the <code>RefinementRule</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Gridap.Adaptivity.get_d_to_face_to_child_faces" href="#Gridap.Adaptivity.get_d_to_face_to_child_faces"><code>Gridap.Adaptivity.get_d_to_face_to_child_faces</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Given a <code>RefinementRule</code>, returns for each parent/coarse face the child/fine faces of the  same dimension that it contains. Therefore, only fine faces at the coarse cell boundary are  listed in the returned structure.</p><p>Returns: [Face dimension][Coarse Face id] -&gt; [Fine faces]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gridap/Gridap.jl/blob/967571175f5a9c3b4a3d9ee320e3f2da817bf4cd/src/Adaptivity/RefinementRules.jl#L119-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Gridap.Adaptivity.get_d_to_face_to_parent_face" href="#Gridap.Adaptivity.get_d_to_face_to_parent_face"><code>Gridap.Adaptivity.get_d_to_face_to_parent_face</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Given a <code>RefinementRule</code>, returns for each fine/child face the parent/coarse face containing it. The parent face can have higher dimension. </p><p>Returns the tuple (A,B) with </p><ul><li>A = [Face dimension][Fine Face id] -&gt; [Parent Face]</li><li>B = [Face dimension][Fine Face id] -&gt; [Parent Face Dimension]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gridap/Gridap.jl/blob/967571175f5a9c3b4a3d9ee320e3f2da817bf4cd/src/Adaptivity/RefinementRules.jl#L157-L164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Gridap.Adaptivity.get_face_subface_ldof_to_cell_ldof" href="#Gridap.Adaptivity.get_face_subface_ldof_to_cell_ldof"><code>Gridap.Adaptivity.get_face_subface_ldof_to_cell_ldof</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Given a <code>RefinementRule</code> of dimension Dc and a Dc-Tuple <code>fine_orders</code> of approximation orders,  returns a map between the fine nodal dofs of order <code>fine_orders</code> in the reference grid and the  coarse nodal dofs of order <code>2⋅fine_orders</code> in the coarse parent cell. </p><p>The result is given for each coarse/parent face of dimension <code>D</code> as a list of the corresponding  fine dof lids, i.e </p><ul><li>[coarse face][coarse dof lid] -&gt; fine dof lid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gridap/Gridap.jl/blob/967571175f5a9c3b4a3d9ee320e3f2da817bf4cd/src/Adaptivity/RefinementRules.jl#L280-L288">source</a></section></article><h3 id="AdaptivityGlue-API"><a class="docs-heading-anchor" href="#AdaptivityGlue-API">AdaptivityGlue API</a><a id="AdaptivityGlue-API-1"></a><a class="docs-heading-anchor-permalink" href="#AdaptivityGlue-API" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Gridap.Adaptivity.get_n2o_reference_coordinate_map" href="#Gridap.Adaptivity.get_n2o_reference_coordinate_map"><code>Gridap.Adaptivity.get_n2o_reference_coordinate_map</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>For each fine cell, returns the map Φ st. x<em>coarse = ϕ(x</em>fine)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gridap/Gridap.jl/blob/967571175f5a9c3b4a3d9ee320e3f2da817bf4cd/src/Adaptivity/AdaptivityGlues.jl#L73-L75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Gridap.Adaptivity.get_old_cell_refinement_rules" href="#Gridap.Adaptivity.get_old_cell_refinement_rules"><code>Gridap.Adaptivity.get_old_cell_refinement_rules</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Given a <code>RefinementGlue</code>, returns an array containing the refinement rules for each   cell in the old mesh. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gridap/Gridap.jl/blob/967571175f5a9c3b4a3d9ee320e3f2da817bf4cd/src/Adaptivity/AdaptivityGlues.jl#L156-L159">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Gridap.Adaptivity.get_new_cell_refinement_rules" href="#Gridap.Adaptivity.get_new_cell_refinement_rules"><code>Gridap.Adaptivity.get_new_cell_refinement_rules</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Given a <code>RefinementGlue</code>, returns an array containing the refinement rules for each   cell in the new mesh. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gridap/Gridap.jl/blob/967571175f5a9c3b4a3d9ee320e3f2da817bf4cd/src/Adaptivity/AdaptivityGlues.jl#L139-L142">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Gridap.Adaptivity.get_d_to_fface_to_cface" href="#Gridap.Adaptivity.get_d_to_fface_to_cface"><code>Gridap.Adaptivity.get_d_to_fface_to_cface</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>For each child/fine face, returns the parent/coarse face containing it. The parent   face might have higher dimension. </p><p>Returns two arrays: </p><ul><li>[dimension][fine face gid] -&gt; coarse parent face gid</li><li>[dimension][fine face gid] -&gt; coarse parent face dimension</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gridap/Gridap.jl/blob/967571175f5a9c3b4a3d9ee320e3f2da817bf4cd/src/Adaptivity/AdaptivityGlues.jl#L206-L214">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Gridap.Adaptivity.n2o_reindex" href="#Gridap.Adaptivity.n2o_reindex"><code>Gridap.Adaptivity.n2o_reindex</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>function n2o_reindex(new_data,g::AdaptivityGlue) -&gt; old_data</code></p><p>Reindexes a cell-wise array from the new mesh to the old mesh.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gridap/Gridap.jl/blob/967571175f5a9c3b4a3d9ee320e3f2da817bf4cd/src/Adaptivity/AdaptivityGlues.jl#L166-L170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Gridap.Adaptivity.o2n_reindex" href="#Gridap.Adaptivity.o2n_reindex"><code>Gridap.Adaptivity.o2n_reindex</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>function o2n_reindex(old_data,g::AdaptivityGlue) -&gt; new_data</code></p><p>Reindexes a cell-wise array from the old mesh to the new mesh.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gridap/Gridap.jl/blob/967571175f5a9c3b4a3d9ee320e3f2da817bf4cd/src/Adaptivity/AdaptivityGlues.jl#L176-L180">source</a></section></article><h3 id="New-to-old-field-evaluations"><a class="docs-heading-anchor" href="#New-to-old-field-evaluations">New-to-old field evaluations</a><a id="New-to-old-field-evaluations-1"></a><a class="docs-heading-anchor-permalink" href="#New-to-old-field-evaluations" title="Permalink"></a></h3><p>When a cell is refined, we need to be able to evaluate the fields defined on the children cells on the parent cell. To do so, we bundle the fields defined on the children cells into a new type of <code>Field</code> called <code>FineToCoarseField</code>. When evaluated on a <code>Point</code>, a <code>FineToCoarseField</code> will select the child cell that contains the <code>Point</code> and evaluate the mapped point on the corresponding child field.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Gridap.Adaptivity.FineToCoarseField" href="#Gridap.Adaptivity.FineToCoarseField"><code>Gridap.Adaptivity.FineToCoarseField</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Given a domain and a non-overlapping refined cover, a <code>FineToCoarseField</code>   is a <code>Field</code> defined in the domain and constructed by a set of fields defined on    the subparts of the covering partition.   The refined cover is represented by a <code>RefinementRule</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gridap/Gridap.jl/blob/967571175f5a9c3b4a3d9ee320e3f2da817bf4cd/src/Adaptivity/FineToCoarseFields.jl#L2-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Gridap.Adaptivity.FineToCoarseDofBasis" href="#Gridap.Adaptivity.FineToCoarseDofBasis"><code>Gridap.Adaptivity.FineToCoarseDofBasis</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gridap/Gridap.jl/blob/967571175f5a9c3b4a3d9ee320e3f2da817bf4cd/src/Adaptivity/FineToCoarseReferenceFEs.jl#L2">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Gridap.Adaptivity.FineToCoarseRefFE" href="#Gridap.Adaptivity.FineToCoarseRefFE"><code>Gridap.Adaptivity.FineToCoarseRefFE</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Wrapper for a ReferenceFE which is specialised for    efficiently evaluating FineToCoarseFields. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gridap/Gridap.jl/blob/967571175f5a9c3b4a3d9ee320e3f2da817bf4cd/src/Adaptivity/FineToCoarseReferenceFEs.jl#L82-L85">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ODEs/">« Gridap.ODEs</a><a class="docs-footer-nextpage" href="../dev-notes/block-assemblers/">Block Assemblers »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Thursday 29 August 2024 22:40">Thursday 29 August 2024</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
