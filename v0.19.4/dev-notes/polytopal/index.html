<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Development notes for polytopal methods · Gridap.jl</title><meta name="title" content="Development notes for polytopal methods · Gridap.jl"/><meta property="og:title" content="Development notes for polytopal methods · Gridap.jl"/><meta property="twitter:title" content="Development notes for polytopal methods · Gridap.jl"/><meta name="description" content="Documentation for Gridap.jl."/><meta property="og:description" content="Documentation for Gridap.jl."/><meta property="twitter:description" content="Documentation for Gridap.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Gridap.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Gridap.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting-started/">Getting Started</a></li><li><a class="tocitem" href="../../Gridap/">Gridap</a></li><li><a class="tocitem" href="../../Helpers/">Gridap.Helpers</a></li><li><a class="tocitem" href="../../Io/">Gridap.Io</a></li><li><a class="tocitem" href="../../Algebra/">Gridap.Algebra</a></li><li><a class="tocitem" href="../../Arrays/">Gridap.Arrays</a></li><li><a class="tocitem" href="../../TensorValues/">Gridap.TensorValues</a></li><li><a class="tocitem" href="../../Fields/">Gridap.Fields</a></li><li><a class="tocitem" href="../../Polynomials/">Gridap.Polynomials</a></li><li><a class="tocitem" href="../../ReferenceFEs/">Gridap.ReferenceFEs</a></li><li><a class="tocitem" href="../../Geometry/">Gridap.Geometry</a></li><li><a class="tocitem" href="../../CellData/">Gridap.CellData</a></li><li><a class="tocitem" href="../../Visualization/">Gridap.Visualization</a></li><li><a class="tocitem" href="../../FESpaces/">Gridap.FESpaces</a></li><li><a class="tocitem" href="../../MultiField/">Gridap.MultiField</a></li><li><a class="tocitem" href="../../ODEs/">Gridap.ODEs</a></li><li><a class="tocitem" href="../../Adaptivity/">Gridap.Adaptivity</a></li><li><span class="tocitem">Developper notes</span><ul><li><a class="tocitem" href="../block-assemblers/">Block Assemblers</a></li><li><a class="tocitem" href="../autodiff/">Autodiff</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Development notes for polytopal methods</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Development notes for polytopal methods</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/gridap/Gridap.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/gridap/Gridap.jl/blob/master/docs/src/dev-notes/polytopal.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Development-notes-for-polytopal-methods"><a class="docs-heading-anchor" href="#Development-notes-for-polytopal-methods">Development notes for polytopal methods</a><a id="Development-notes-for-polytopal-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Development-notes-for-polytopal-methods" title="Permalink"></a></h1><h2 id="Hybrid-assembly"><a class="docs-heading-anchor" href="#Hybrid-assembly">Hybrid assembly</a><a id="Hybrid-assembly-1"></a><a class="docs-heading-anchor-permalink" href="#Hybrid-assembly" title="Permalink"></a></h2><p>The idea behind the following implementation is the following:</p><p>After a lot of thought, I think we probably cannot create cell-wise facet basis functions. The problem is efficiency: If we do so, we would be forced to pad the elemental cell matrices with zeros for those dofs evaluated at points that do not belong to the facet. We can still explore this idea for specific discretizations, but I think for methods where the dofs actually belong to the faces (i.e HDG, HHO, ...) this is not the way to go.</p><p>I think the key to efficiently implement hybrid assembly is leveraging the concept of patch-assembly, similar to what we do for GMG:</p><ul><li>First, we want to allow for overlapped triangulations. In this way, we can imagine a hybrid skeleton as a boundary triangulation of facets wrapped around the cells. I.e instead of what the current SkeletonTriangulation does, we have a single triangulation that contains each facet twice (once for each neighboring cell). The only thing missing is to tie back each facet to the cell it belongs to.</li><li>This is where patches come into play. We have already been exploring patches for GMG + domain decomposition methods. In the simplest form, we consider one patch per cell, and each patch contains the cell itself and all touching facets.</li><li>In the future, we could imagine more complex patches that contain more than one cell. This ties into the idea Santi had to explore small-domain BDDC solvers (where the coarse space is not tied to processors, but rather to some arbitrary domain decomposition).</li><li>Once we have our patches, we have to create the machinery to assemble each patch individually. I.e we take the mesh-wide arrays, select the cells/faces that belong to each patch and assemble patch-local matrices. This can be done lazily (i.e we reuse the same matrix-vector for each patch).</li><li>On top the of the resulting array of patch-local systems, one can easily create patch-local maps to implement features such as static condensations for HDG, reconstruction operators for HHO, etc...</li></ul><p>The following are the files containing the implementation of the above ideas:</p><ul><li>Patches and patch triangulations: <code>src/Geometry/PatchTriangulations.jl</code></li><li>Patch Assembly for single-field: <code>src/FESpaces/PatchAssemblers.jl</code></li><li>Patch Assembly for multi-field: <code>src/MultiField/PatchAssemblers.jl</code></li></ul><h2 id="Logging-some-difficulties"><a class="docs-heading-anchor" href="#Logging-some-difficulties">Logging some difficulties</a><a id="Logging-some-difficulties-1"></a><a class="docs-heading-anchor-permalink" href="#Logging-some-difficulties" title="Permalink"></a></h2><p>For static condensation, the current approach is to gather the <code>cell_dof_ids</code> patch per patch, to create the <code>patch_dof_ids</code>. This gets rid of the face-wise splitting and merges all dofs belonging to a single patch into a single array.</p><p>Then, given a tuple <code>(dofs,patch)</code>, we can find the local ids of those dofs within the <code>patch_dofs[patch]</code> array. To do this efficiently, we have to sort each of the sub-arrays in <code>patch_dofs</code> in order to be able to use <code>searchsortedfirst</code>. Also, we remove completely boundary conditions, since the matrix-vector pairs resulting from static condensation already have had their boundary conditions applied.</p><p>The issue that this causes is that for HHO we will have two instances of the patch dofs: One with boundary conditions and one without, and both of them will have all dofs (i.e also with negative ids). The one without boundary conditions is needed to create local projection operators. The one with is to globally assemble the result of the local projection operators.</p><p>So for a cell</p><pre><code class="nohighlight hljs">        2
   ----------
   |        |
  3|        |-1
   |        |
   ----------
        1</code></pre><p>we would have 3 versions of the patch dofs: </p><pre><code class="nohighlight hljs">  [1,2,3]    # bcs removed
  [1,2,3,4]  # space without bcs
  [1,2,3,-1] # space with bcs</code></pre></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 8 August 2025 23:16">Friday 8 August 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
